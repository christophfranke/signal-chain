<!DOCTYPE html><html class="default" lang="en"><head><meta charSet="utf-8"/><meta http-equiv="x-ua-compatible" content="IE=edge"/><title>signal-chain</title><meta name="description" content="Documentation for signal-chain"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="stylesheet" href="assets/style.css"/><link rel="stylesheet" href="assets/highlight.css"/><script defer src="assets/main.js"></script><script async src="assets/icons.js" id="tsd-icons-script"></script><script async src="assets/search.js" id="tsd-search-script"></script><script async src="assets/navigation.js" id="tsd-nav-script"></script></head><body><script>document.documentElement.dataset.theme = localStorage.getItem("tsd-theme") || "os";document.body.style.display="none";setTimeout(() => app?app.showPage():document.body.style.removeProperty("display"),500)</script><header class="tsd-page-toolbar"><div class="tsd-toolbar-contents container"><div class="table-cell" id="tsd-search" data-base="."><div class="field"><label for="tsd-search-field" class="tsd-widget tsd-toolbar-icon search no-caption"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-search"></use></svg></label><input type="text" id="tsd-search-field" aria-label="Search"/></div><div class="field"><div id="tsd-toolbar-links"></div></div><ul class="results"><li class="state loading">Preparing search index...</li><li class="state failure">The search index is not available</li></ul><a href="index.html" class="title">signal-chain</a></div><div class="table-cell" id="tsd-widgets"><a href="#" class="tsd-widget tsd-toolbar-icon menu no-caption" data-toggle="menu" aria-label="Menu"><svg width="16" height="16" viewBox="0 0 16 16" fill="none"><use href="assets/icons.svg#icon-menu"></use></svg></a></div></div></header><div class="container container-main"><div class="col-content"><div class="tsd-page-title"><h2>signal-chain</h2></div><div class="tsd-panel tsd-typography"><a id="md:signal-chain" class="tsd-anchor"></a><h1><a href="#md:signal-chain">Signal-Chain</a></h1><a id="md:a-declarative-reactive-programming-library" class="tsd-anchor"></a><h2><a href="#md:a-declarative-reactive-programming-library">A Declarative Reactive Programming Library</a></h2><p><strong>Signal-Chain</strong> is a library for composing observables and asynchronous operations. It provides a core type, the Chain, several operators (select, effect, await, listen, combine, ...), and a reactive Primitive to combine declarative state management with asynchronous operations.</p>
<blockquote>
<p>Signal-Chain is a smaller and simpler RxJS.</p>
</blockquote>
<p>The essential concepts of <strong>Signal-Chain</strong> are:</p>
<ul>
<li><strong>Primitive</strong>: Represents a single reactive value.</li>
<li><strong>Chain</strong>: A series of operations. Can be connected to update a primitive.</li>
<li><strong>Element</strong>: A single operation in a chain. Every chain can be an element of another chain.</li>
<li><strong>Listener</strong>: A subscription to a reactive value. Can be an element in a chain.</li>
<li><strong>Operator</strong>: An element in a chain, that modifies the behaviour of a sub chain.</li>
</ul>
<p><strong>Installation</strong>:</p>
<pre><code class="language-sh"><span class="hl-0">npm</span><span class="hl-1"> </span><span class="hl-2">install</span><span class="hl-1"> </span><span class="hl-2">signal-chain</span>
</code><button>Copy</button></pre>
<a id="md:examples" class="tsd-anchor"></a><h3><a href="#md:examples">Examples</a></h3><p><strong>Getting Started</strong></p>
<p>Let&#39;s define a primitive.</p>
<pre><code class="language-typescript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">$</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;signal-chain&#39;</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">counter</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">(</span><span class="hl-7">0</span><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>Now we can define a chain that listens to the counter and logs the value using the <code>effect</code> operator.</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">log</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">chain</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">counter</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">,</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">effect</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1">))</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>When we connect the chain, it will start listening to the counter.</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">disconnect</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">(</span><span class="hl-4">log</span><span class="hl-1">) </span><span class="hl-8">// logs: 0</span><br/><br/><span class="hl-4">counter</span><span class="hl-1">.</span><span class="hl-4">value</span><span class="hl-1"> = </span><span class="hl-7">1</span><span class="hl-1"> </span><span class="hl-8">// logs: 1</span>
</code><button>Copy</button></pre>
<p>We can also rewrite the value into something different with the <code>select</code> operation.</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">formatted</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">chain</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">counter</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">,</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(</span><span class="hl-4">x</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-2">`The number is </span><span class="hl-5">${</span><span class="hl-4">x</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">)</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>And then we create a primitive that is connected to the formatted chain.</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">formattedValue</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">(</span><span class="hl-4">formatted</span><span class="hl-1">)</span><br/><br/><span class="hl-4">counter</span><span class="hl-1">.</span><span class="hl-4">value</span><span class="hl-1"> = </span><span class="hl-7">10</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">formattedValue</span><span class="hl-1">.</span><span class="hl-4">value</span><span class="hl-1">) </span><span class="hl-8">// logs: The number is 10</span>
</code><button>Copy</button></pre>
<p><strong>Reusability</strong></p>
<p>In the above example, we formatted a counter value. Sometimes, we want to specify behaviour, but want to apply it to different sources. We can do that, by creating a chain that requires an input value.</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">format</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">chain</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">&lt;</span><span class="hl-9">number</span><span class="hl-1">&gt;(</span><span class="hl-4">x</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">Math</span><span class="hl-1">.</span><span class="hl-0">round</span><span class="hl-1">(</span><span class="hl-4">x</span><span class="hl-1">)),</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-4">x</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">x</span><span class="hl-1"> &gt; </span><span class="hl-7">1</span><span class="hl-1">)(</span><br/><span class="hl-1">      </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(</span><span class="hl-4">x</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-2">`We have </span><span class="hl-5">${</span><span class="hl-4">x</span><span class="hl-5">}</span><span class="hl-2"> apples`</span><span class="hl-1">)</span><br/><span class="hl-1">   ),</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-4">x</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">x</span><span class="hl-1"> === </span><span class="hl-7">1</span><span class="hl-1">)(</span><br/><span class="hl-1">      </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-2">`We have an apple`</span><span class="hl-1">)</span><br/><span class="hl-1">   ),</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">if</span><span class="hl-1">(</span><span class="hl-4">x</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">x</span><span class="hl-1"> === </span><span class="hl-7">0</span><span class="hl-1">)(</span><br/><span class="hl-1">      </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-2">`We have no apples`</span><span class="hl-1">)</span><br/><span class="hl-1">   ),</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">assert</span><span class="hl-1">.</span><span class="hl-0">isNumber</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-2">&#39;I cannot handle negative apples. Or NaN apples.&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">   )</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>Here we have created a chain, that will format a number into a string. There are a few things going on:</p>
<ul>
<li>The first <code>$.select</code> has a type parameter <code>number</code>, that specifies that we expect a number as input. If we do not specify this, typescript will infer <code>unknown</code> and complain about the <code>Math.round(x)</code> operation. This is the recommended approach of defining input types. If the first operator is not a <code>$.select</code>, you can always add an empty select operation <code>$.select&lt;ExpectedType&gt;()</code>.</li>
<li>The <code>$.if</code> operator is a higher order operator. That means, it expects a chain (or multiple elements) as a parameter. They define the <em>inner chain</em>. The <em>inner chain</em> will only execute, if the condition is true.</li>
<li>The <code>$.assert</code> operator, also a higher order operator, is similar to the <code>$.if</code> operator, in that if the condition is met, the <em>inner chain</em> will execute. In contrast to the <code>$.if</code> operator, it performs static type inference. Here, all <code>number</code> input is rewritten into a <code>string</code> by the <code>$.select</code> operator, causing typescript to infer that the signal thereafter is always a <code>string</code>.</li>
</ul>
<p>We can now use this chain to format a number.</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">counter</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">(</span><span class="hl-7">0</span><span class="hl-1">)</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">formatted</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">counter</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">,</span><br/><span class="hl-1">   </span><span class="hl-4">format</span><span class="hl-1">,</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">effect</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">value</span><span class="hl-1">)) </span><span class="hl-8">// logs: We have no apples</span><br/><span class="hl-1">)</span><br/><br/><span class="hl-4">counter</span><span class="hl-1">.</span><span class="hl-4">value</span><span class="hl-1"> = </span><span class="hl-7">10</span><span class="hl-1"> </span><span class="hl-8">// logs: We have 10 apples</span><br/><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-4">formatted</span><span class="hl-1">.</span><span class="hl-4">value</span><span class="hl-1">) </span><span class="hl-8">// logs: We have 10 apples</span>
</code><button>Copy</button></pre>
<p><strong>Asynchronous Operations</strong></p>
<p>Admittedly, this type of formatting could have been done with a simple function. Let us take this approach and combine it with some asynchronous logic, so we can see the real value of the chain.</p>
<p>Here, we will implement an auto suggest feature, that fetches some data from an API and logs the result.</p>
<pre><code class="language-typescript"><span class="hl-3">import</span><span class="hl-1"> </span><span class="hl-4">$</span><span class="hl-1"> </span><span class="hl-3">from</span><span class="hl-1"> </span><span class="hl-2">&#39;signal-chain&#39;</span><br/><br/><span class="hl-8">// store user input into a reactive primitive</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">input</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">(</span><span class="hl-2">&#39;&#39;</span><span class="hl-1">)</span><br/><span class="hl-4">document</span><span class="hl-1">.</span><span class="hl-0">getElementById</span><span class="hl-1">(</span><span class="hl-2">&#39;my-input&#39;</span><span class="hl-1">)?.</span><span class="hl-0">addEventListener</span><span class="hl-1">(</span><span class="hl-2">&#39;input&#39;</span><span class="hl-1">, (</span><span class="hl-4">event</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> {</span><br/><span class="hl-1">   </span><span class="hl-4">input</span><span class="hl-1">.</span><span class="hl-4">value</span><span class="hl-1"> = (</span><span class="hl-4">event</span><span class="hl-1">.</span><span class="hl-4">target</span><span class="hl-1"> </span><span class="hl-3">as</span><span class="hl-1"> </span><span class="hl-9">HTMLInputElement</span><span class="hl-1">).</span><span class="hl-4">value</span><br/><span class="hl-1">})</span><br/><br/><span class="hl-8">// resolves after ms with input</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-0">wait</span><span class="hl-1"> = &lt;</span><span class="hl-9">T</span><span class="hl-1">&gt;(</span><span class="hl-4">input</span><span class="hl-1">: </span><span class="hl-9">T</span><span class="hl-1">, </span><span class="hl-4">ms</span><span class="hl-1">: </span><span class="hl-9">number</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-5">new</span><span class="hl-1"> </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">T</span><span class="hl-1">&gt;(</span><br/><span class="hl-1">   </span><span class="hl-4">resolve</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">setTimeout</span><span class="hl-1">(</span><br/><span class="hl-1">      () </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">resolve</span><span class="hl-1">(</span><span class="hl-4">input</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">ms</span><br/><span class="hl-1">   )</span><br/><span class="hl-1">)</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">suggestions</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">input</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">,</span><br/><br/><span class="hl-1">   </span><span class="hl-8">// debounce 150ms</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">await</span><span class="hl-1">.</span><span class="hl-0">latest</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(</span><span class="hl-4">input</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">wait</span><span class="hl-1">(</span><span class="hl-4">input</span><span class="hl-1">, </span><span class="hl-7">150</span><span class="hl-1">)),</span><br/><span class="hl-1">   ),</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">assert</span><span class="hl-1">.</span><span class="hl-4">not</span><span class="hl-1">.</span><span class="hl-0">isError</span><span class="hl-1">(), </span><span class="hl-8">// type narrowing</span><br/><br/><span class="hl-1">   </span><span class="hl-8">// fetch if input is long enough, otherwise fall back to empty array</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">if</span><span class="hl-1">((</span><span class="hl-4">input</span><span class="hl-1">: </span><span class="hl-9">string</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">input</span><span class="hl-1">.</span><span class="hl-4">length</span><span class="hl-1"> &gt; </span><span class="hl-7">2</span><span class="hl-1">, [])(</span><br/><span class="hl-1">      </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(</span><span class="hl-4">input</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-2">`/api/suggest/</span><span class="hl-5">${</span><span class="hl-4">input</span><span class="hl-5">}</span><span class="hl-2">`</span><span class="hl-1">),</span><br/><span class="hl-1">      </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">await</span><span class="hl-1">.</span><span class="hl-0">latest</span><span class="hl-1">(</span><br/><span class="hl-1">         </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(</span><span class="hl-4">url</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-0">fetch</span><span class="hl-1">(</span><span class="hl-4">url</span><span class="hl-1">).</span><span class="hl-0">then</span><span class="hl-1">(</span><span class="hl-4">response</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">response</span><span class="hl-1">.</span><span class="hl-0">json</span><span class="hl-1">()) </span><span class="hl-3">as</span><span class="hl-1"> </span><span class="hl-9">Promise</span><span class="hl-1">&lt;</span><span class="hl-9">string</span><span class="hl-1">[]&gt;),</span><br/><span class="hl-1">      ),</span><br/><span class="hl-1">      </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">assert</span><span class="hl-1">.</span><span class="hl-0">isError</span><span class="hl-1">(</span><br/><span class="hl-1">         </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">effect</span><span class="hl-1">(</span><span class="hl-4">err</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">console</span><span class="hl-1">.</span><span class="hl-0">error</span><span class="hl-1">(</span><span class="hl-2">&#39;Error fetching suggestions:&#39;</span><span class="hl-1">, </span><span class="hl-4">err</span><span class="hl-1">)),</span><br/><span class="hl-1">         </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(() </span><span class="hl-5">=&gt;</span><span class="hl-1"> [])</span><br/><span class="hl-1">      ),</span><br/><span class="hl-1">   ),</span><br/><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">log</span><span class="hl-1">(</span><span class="hl-2">&#39;Suggestions:&#39;</span><span class="hl-1">) </span><span class="hl-8">// Suggestions: [&#39;So&#39;, &#39;many&#39;, &#39;suggestions&#39;, ...]</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>In this example we first store the user input in a reactive primitive. We use that to primitive as a starting point to define the chain to fetch the suggestions.</p>
<p>Let&#39;s have a look at the debounce part:</p>
<ul>
<li>The <code>$.await.latest</code> operator will pass on the latest resolved value. If a value is incoming while the previous promise is still pending, the previous promise will be cancelled and the resolve of the new one is awaited instead.</li>
<li>Together with the wait function, this will effectively create a debounce, only passing on the input when there is no new value for 150 ms.</li>
</ul>
<p>When given no argument, <code>$.assert.not.isError()</code> will pass on the value if it is not an error, otherwise it throws. We use it here to ensure type consistency: <code>$.await.latest</code> cannot know, if a promise will resolve or reject. Therefore, it passes on <code>TypeOfPromiseResolve | Error</code>. Because we know that our wait function cannot reject, we can safely assert that there is no error. The assertion operator then removes the <code>Error</code> type from the chain.</p>
<p><em>Why</em> is it designed like this? It follows the principle of <strong>errors as values</strong>. This reminds the developer that at this place something can go wrong and we need to handle it somehow. If we were not to handle the error at all, the suggestion pimitive would have an inferred type of <code>string[] | Error</code>.</p>
<p>The <code>$.if</code> operator has a second parameter, which is the fallback value. If the condition is not met, the fallback value will be used instead. If no fallback is given and the condition is not met, the input is being passed through unchanged.</p>
<p>The <code>$.await.latest</code> is also exactly what we want in fetching data. If a new input is given while the previous request is still pending, the previous request will be cancelled. This is similar to the RxJS behviour of <code>switchMap</code>. For other scenarios there are 4 more await operators with different strategies:</p>
<ul>
<li><code>$.await.parallel</code>: Passes on all resolved values in the order they resolve.</li>
<li><code>$.await.order</code>: Passes on all resolved values in the order they were requested.</li>
<li><code>$.await.block</code>: Will only enter the inner block when no promise is pending. Incoming values will be discarded.</li>
<li><code>$.await.queue</code>: Will only enter the inner block when no promise is pending. Incoming values will be queued and processed by the inner block once the pending promise is resolved.</li>
</ul>
<p><strong>Reactivity with Plain Objects</strong></p>
<p>Sometimes you may work with existing logic, or maybe you prefer to store our state in plain objects. <strong>Signal-Chain</strong> can listen to plain objects and arrays using proxies.</p>
<p>Let&#39;s assumet we have a state object like this:</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">state</span><span class="hl-1"> = {</span><br/><span class="hl-1">   </span><span class="hl-4">filter:</span><span class="hl-1"> </span><span class="hl-2">&#39;&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">   </span><span class="hl-4">elements:</span><span class="hl-1"> [</span><br/><span class="hl-1">      { </span><span class="hl-4">age:</span><span class="hl-1"> </span><span class="hl-7">25</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;Alice&#39;</span><span class="hl-1"> },</span><br/><span class="hl-1">      { </span><span class="hl-4">age:</span><span class="hl-1"> </span><span class="hl-7">73</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;Bob&#39;</span><span class="hl-1"> },</span><br/><span class="hl-1">      { </span><span class="hl-4">age:</span><span class="hl-1"> </span><span class="hl-7">42</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;Charlie&#39;</span><span class="hl-1"> },</span><br/><span class="hl-1">      { </span><span class="hl-4">age:</span><span class="hl-1"> </span><span class="hl-7">18</span><span class="hl-1">, </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;David&#39;</span><span class="hl-1"> },</span><br/><span class="hl-1">   ]</span><br/><span class="hl-1">}</span>
</code><button>Copy</button></pre>
<p>And let&#39;s further assume there is pre-existing logic spread out over the source code, that sets the filter and the elements. We can still listen to changes of the filter and the elements:</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">filter</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">emit</span><span class="hl-1">(</span><span class="hl-4">state</span><span class="hl-1">), </span><span class="hl-8">// emit the state object</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">.</span><span class="hl-0">key</span><span class="hl-1">(</span><span class="hl-2">&#39;filter&#39;</span><span class="hl-1">), </span><span class="hl-8">// listen to changes in the filter key</span><br/><span class="hl-1">)</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">elements</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">emit</span><span class="hl-1">(</span><span class="hl-4">state</span><span class="hl-1">), </span><span class="hl-8">// emit the state object</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">.</span><span class="hl-0">key</span><span class="hl-1">(</span><span class="hl-2">&#39;elements&#39;</span><span class="hl-1">), </span><span class="hl-8">// listen to changes in the elements key</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<ul>
<li>The <code>$.emit</code> operator has no input and emits the passed argument.</li>
<li>The <code>$.listen.key</code> operator will listen to changes in the given key of the incoming object. Whenever the value changes, it will fire. If the value of the key is an array type, the listener will be attached to the array itself via proxy, so that any changes to the array will also be detected.</li>
</ul>
<p>This is how we could implement a reactive filter:</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">filteredElements</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">combine</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-4">elements</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">,</span><br/><span class="hl-1">      </span><span class="hl-4">filter</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">,</span><br/><span class="hl-1">   ),</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(</span><br/><span class="hl-1">      ([</span><span class="hl-4">elements</span><span class="hl-1">, </span><span class="hl-4">filter</span><span class="hl-1">]) </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">elements</span><span class="hl-1">.</span><span class="hl-0">filter</span><span class="hl-1">(</span><br/><span class="hl-1">         </span><span class="hl-4">element</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">element</span><span class="hl-1">.</span><span class="hl-4">name</span><span class="hl-1">.</span><span class="hl-0">includes</span><span class="hl-1">(</span><span class="hl-4">filter</span><span class="hl-1">)</span><br/><span class="hl-1">      )</span><br/><span class="hl-1">   )</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>Here we use the <code>$.combine</code> operator, which takes a list of elements, and combines them into one element that emits an array. Whenever one of the elements fires with a new value, the combined element will fire with the latest values of all elements.</p>
<p>There is a subtle caveat in this example:</p>
<pre><code class="language-typescript"><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">filter</span><span class="hl-1"> = </span><span class="hl-2">&#39;Alice&#39;</span><span class="hl-1"> </span><span class="hl-8">// this works as expected</span><br/><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">elements</span><span class="hl-1">.</span><span class="hl-0">push</span><span class="hl-1">({</span><br/><span class="hl-1">   </span><span class="hl-4">age:</span><span class="hl-1"> </span><span class="hl-7">42</span><span class="hl-1">,</span><br/><span class="hl-1">   </span><span class="hl-4">name:</span><span class="hl-1"> </span><span class="hl-2">&#39;Eve&#39;</span><br/><span class="hl-1">}) </span><span class="hl-8">// this is also fine</span><br/><br/><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">elements</span><span class="hl-1">[</span><span class="hl-7">0</span><span class="hl-1">] = {</span><br/><span class="hl-1">   </span><span class="hl-2">&#39;Alicia&#39;</span><span class="hl-1">,</span><br/><span class="hl-1">   </span><span class="hl-4">age:</span><span class="hl-1"> </span><span class="hl-7">53</span><br/><span class="hl-1">} </span><span class="hl-8">// also fine</span><br/><span class="hl-4">state</span><span class="hl-1">.</span><span class="hl-4">elements</span><span class="hl-1">[</span><span class="hl-7">0</span><span class="hl-1">].</span><span class="hl-4">name</span><span class="hl-1"> = </span><span class="hl-2">&#39;Bob&#39;</span><span class="hl-1"> </span><span class="hl-8">// this will not trigger the chain</span>
</code><button>Copy</button></pre>
<p>The reason for that is, that although the <code>$.listen.key(&#39;elements&#39;)</code> listens to all array changes, the change to the name property of the array is not considered a change to the array itself. Also, <code>$.select</code> is not a reactive context. Only the <code>$.listen</code> operator is reactive. If we want to listen to changes to the keys of the objects, that are the elements of the array, we need to add another listener to the key:</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">names</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">chain</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">emit</span><span class="hl-1">(</span><span class="hl-4">state</span><span class="hl-1">),</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">.</span><span class="hl-0">key</span><span class="hl-1">(</span><span class="hl-2">&#39;elements&#39;</span><span class="hl-1">),</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">each</span><span class="hl-1">(</span><br/><span class="hl-1">      </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">.</span><span class="hl-0">key</span><span class="hl-1">(</span><span class="hl-2">&#39;name&#39;</span><span class="hl-1">)</span><br/><span class="hl-1">   )</span><br/><span class="hl-1">)</span><br/>
</code><button>Copy</button></pre>
<p>The <code>$.each</code> operator is a higher order operator, that expects a chain as argument. It will apply the chain to each element of an array. In this case, it will listen to changes in the <code>name</code> key of each element in the <code>elements</code> array.</p>
<p>It is possible that future versions will have a <code>$.listen.select</code> operator, which is automatically reactive. For now, however, we have to subscribe manually, which on the other hand has the great benefit of being explicit.</p>
<p><strong>Types and Inferrence</strong></p>
<p>We have so far used code with minimal type information. <em>Signal-Chain</em> is fully typed and built with type inferrence in mind. In all the above examples we have complete inferrence. Typescript will also protect us from making any mistakes, like chaining the wrong chains together:</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">hallo</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">(</span><span class="hl-2">&#39;welt&#39;</span><span class="hl-1">) </span><span class="hl-8">// inferred as string</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">formatted</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">connect</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">hallo</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">,</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(</span><span class="hl-4">x</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">Math</span><span class="hl-1">.</span><span class="hl-0">round</span><span class="hl-1">(</span><span class="hl-4">x</span><span class="hl-1">)) </span><span class="hl-8">// &lt;-- typescript error:</span><br/><span class="hl-1">   </span><span class="hl-8">// Argument of type &#39;string&#39; is not assignable to parameter of type &#39;number&#39;.</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>Sometimes a little context is necessary</p>
<pre><code class="language-typescript"><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">multiplicator</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">chain</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">(</span><span class="hl-4">x</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">x</span><span class="hl-1"> * </span><span class="hl-7">5</span><span class="hl-1">) </span><span class="hl-8">// &lt;-- typescript error: x is unknown</span><br/><span class="hl-1">)</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">numberMultiplicator</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">chain</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">&lt;</span><span class="hl-9">number</span><span class="hl-1">&gt;(</span><span class="hl-4">x</span><span class="hl-1"> </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">x</span><span class="hl-1"> * </span><span class="hl-7">5</span><span class="hl-1">) </span><span class="hl-8">// now we are good</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>In case you do want to be more general, you need to use a function with a generic</p>
<pre><code class="language-typescript"><span class="hl-8">// creates a chain from T -&gt; boolean</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-0">truthyness</span><span class="hl-1"> = &lt;</span><span class="hl-9">T</span><span class="hl-1">&gt;() </span><span class="hl-5">=&gt;</span><span class="hl-1"> </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">chain</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">select</span><span class="hl-1">((</span><span class="hl-4">x</span><span class="hl-1">: </span><span class="hl-9">T</span><span class="hl-1">) </span><span class="hl-5">=&gt;</span><span class="hl-1"> !!</span><span class="hl-4">x</span><span class="hl-1">) </span><span class="hl-8">// output type boolean inferred</span><br/><span class="hl-1">)</span><br/><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">counter</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-4">primitive</span><span class="hl-1">.</span><span class="hl-0">create</span><span class="hl-1">(</span><span class="hl-7">0</span><span class="hl-1">)</span><br/><span class="hl-5">const</span><span class="hl-1"> </span><span class="hl-6">somechain</span><span class="hl-1"> = </span><span class="hl-4">$</span><span class="hl-1">.</span><span class="hl-0">chain</span><span class="hl-1">(</span><br/><span class="hl-1">   </span><span class="hl-4">counter</span><span class="hl-1">.</span><span class="hl-4">listen</span><span class="hl-1">,</span><br/><span class="hl-1">   </span><span class="hl-0">truthyness</span><span class="hl-1">() </span><span class="hl-8">// T gets inferred to number</span><br/><span class="hl-1">)</span>
</code><button>Copy</button></pre>
<p>Additionally, <strong>Signal-Chain</strong> includes these operators:</p>
<ul>
<li><code>$.catch</code>: Catches errors and passes them on as values.</li>
<li><code>$.count</code>: Counts the number of incoming values.</li>
<li><code>$.collect</code>: Collects all incoming values.</li>
<li><code>$.listen.event</code>: Listens to DOM Events.</li>
<li><code>$.merge</code>: Merges multiple chains into a single one.</li>
<li><code>$.stop</code>: Stops the chain.</li>
<li><code>$.passIf</code>: Passes on the value if the condition is met.</li>
<li><code>$.stopIf</code>: Stops the chain if the condition is met.</li>
<li><code>$.ifNot</code>: Negation of <code>$.if</code> without fallback.</li>
<li><code>$.passUnique</code>: Passes only unique values.</li>
<li><code>$.assert.create</code>: Creates a custom assertion from a type predicate function.</li>
<li><code>$.assert.not.create</code>: Creates a custom negated assertion from a type predicate function.</li>
</ul>
<a id="md:documentation" class="tsd-anchor"></a><h3><a href="#md:documentation">Documentation</a></h3><p>For more detail, have a look at the official <a href="https://christophfranke.github.io/signal-chain">documentation</a>.
Please note, the documentation is still in progress.</p>
<a id="md:known-issues" class="tsd-anchor"></a><h3><a href="#md:known-issues">Known Issues</a></h3><p>This is a very new library and there is no guarantee that the API is stable. Please use with caution and report any issues you encounter.</p>
<ul>
<li>When listening to an object key, and the key had an array type, but is now being assigned a non-array, the application throws an error unsupported.</li>
<li>Options and behaviour of update batching and async updates is not stable yet. There are several options and there will be a way to turn on/off batching and asnyc, the default configuration may change though.</li>
</ul>
</div></div><div class="col-sidebar"><div class="page-menu"><div class="tsd-navigation settings"><details class="tsd-index-accordion"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>Settings</h3></summary><div class="tsd-accordion-details"><div class="tsd-filter-visibility"><h4 class="uppercase">Member Visibility</h4><form><ul id="tsd-filter-options"><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-protected" name="protected"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Protected</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-private" name="private"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Private</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-inherited" name="inherited" checked/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>Inherited</span></label></li><li class="tsd-filter-item"><label class="tsd-filter-input"><input type="checkbox" id="tsd-filter-external" name="external"/><svg width="32" height="32" viewBox="0 0 32 32" aria-hidden="true"><rect class="tsd-checkbox-background" width="30" height="30" x="1" y="1" rx="6" fill="none"></rect><path class="tsd-checkbox-checkmark" d="M8.35422 16.8214L13.2143 21.75L24.6458 10.25" stroke="none" stroke-width="3.5" stroke-linejoin="round" fill="none"></path></svg><span>External</span></label></li></ul></form></div><div class="tsd-theme-toggle"><h4 class="uppercase">Theme</h4><select id="tsd-theme"><option value="os">OS</option><option value="light">Light</option><option value="dark">Dark</option></select></div></div></details></div><details open class="tsd-index-accordion tsd-page-navigation"><summary class="tsd-accordion-summary"><h3><svg width="20" height="20" viewBox="0 0 24 24" fill="none"><use href="assets/icons.svg#icon-chevronDown"></use></svg>On This Page</h3></summary><div class="tsd-accordion-details"><a href="#md:signal-chain"><span>Signal-<wbr/>Chain</span></a><ul><li><a href="#md:a-declarative-reactive-programming-library"><span>A <wbr/>Declarative <wbr/>Reactive <wbr/>Programming <wbr/>Library</span></a></li><li><ul><li><a href="#md:examples"><span>Examples</span></a></li><li><a href="#md:documentation"><span>Documentation</span></a></li><li><a href="#md:known-issues"><span>Known <wbr/>Issues</span></a></li></ul></li></ul></div></details></div><div class="site-menu"><nav class="tsd-navigation"><a href="modules.html" class="current"><svg class="tsd-kind-icon" viewBox="0 0 24 24"><use href="assets/icons.svg#icon-1"></use></svg><span>signal-chain</span></a><ul class="tsd-small-nested-navigation" id="tsd-nav-container" data-base="."><li>Loading...</li></ul></nav></div></div></div><div class="tsd-generator"><p>Generated using <a href="https://typedoc.org/" target="_blank">TypeDoc</a></p></div><div class="overlay"></div></body></html>